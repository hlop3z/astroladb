---
title: CLI Commands
---

Complete reference for all Astroladb (`alab`) CLI commands.

---

## Development Commands

### `alab init`

Initialize a new project. Creates `schemas/`, `migrations/`, and `types/`
directories along with an `alab.yaml` config file.

```bash
alab init
```

Use `--demo` to scaffold a sample schema:

```bash
alab init --demo
```

### `alab table`

Create a new table schema file. Takes a namespace and table name.

```bash
alab table auth user
```

This creates `schemas/auth/user.js`.

### `alab live`

Start a local server for live API documentation. Useful for browsing your schema
interactively.

```bash
alab live
```

### `alab export`

Export the schema in a given format.

```bash
alab export -f openapi
alab export -f graphql
alab export -f typescript
alab export -f python
alab export -f go
alab export -f rust

# Include relationship fields (WithRelations variants)
alab export -f typescript --relations
```

| Flag          | Description                                                                      |
| ------------- | -------------------------------------------------------------------------------- |
| `-f`          | **Required.** Format: `openapi`, `graphql`, `typescript`, `go`, `python`, `rust` |
| `--relations` | Generate `WithRelations` type variants with relationship fields                  |
| `--namespace` | Filter export to a specific namespace                                            |

---

## Migration Commands

### `alab new`

Generate a migration from the current schema diff. The argument is a descriptive
name for the migration.

```bash
alab new create_users
```

### `alab migrate`

Apply all pending migrations.

```bash
alab migrate
```

Preview the SQL without applying:

```bash
alab migrate --dry
```

Apply and auto-commit to git:

```bash
alab migrate --commit
```

Verify SQL checksums before applying:

```bash
alab migrate --verify-sql
```

| Flag                | Description                                      |
| ------------------- | ------------------------------------------------ |
| `--dry`             | Print SQL without executing                      |
| `--force`           | Skip safety warnings and confirmation prompts    |
| `--confirm-destroy` | Confirm DROP operations                          |
| `--commit`          | Auto-commit migration files to git after apply   |
| `--skip-lock`       | Skip distributed locking (use in CI)             |
| `--lock-timeout`    | Lock acquisition timeout (default 30s)           |
| `--verify-sql`      | Verify SQL checksums against stored values first |

### `alab rollback`

Roll back the most recent migration. Pass a number to roll back multiple steps.

```bash
alab rollback
alab rollback 3
```

### `alab reset`

Drop all tables and re-run every migration from scratch. Development only.

```bash
alab reset
```

### `alab check`

Validate schema files or lint migration files for safety issues.

```bash
# Validate all schema files
alab check

# Lint migration files for destructive operations, missing defaults, etc.
alab check --migrations

# Verify SQL determinism for applied migrations
alab check --determinism
```

| Flag            | Description                                                  |
| --------------- | ------------------------------------------------------------ |
| `--migrations`  | Lint migration files instead of validating schemas           |
| `--determinism` | Re-generate SQL for applied migrations and compare checksums |

#### Schema validation (default)

Loads all schema files through the sandbox and runs structural validation —
missing primary keys, invalid column types, broken references, duplicate
definitions, etc. Exits with code 1 on any error.

#### Migration linting (`--migrations`)

Scans migration operations and warns about:

| Rule                         | Trigger                                                                                              | Message                                          |
| ---------------------------- | ---------------------------------------------------------------------------------------------------- | ------------------------------------------------ |
| **Drop table**               | `m.drop_table()`                                                                                     | Will DELETE ALL DATA in table                    |
| **Drop column**              | `m.drop_column()`                                                                                    | Will DELETE DATA in column                       |
| **NOT NULL without default** | `m.add_column()` with a NOT NULL column that has no `default()`, `backfill()`, or `server_default()` | NOT NULL column has no default or backfill value |
| **Reserved SQL word**        | Table or column name matches a SQL reserved word (`user`, `order`, `type`, `select`, etc.)           | Identifier is a SQL reserved word                |
| **Lock file integrity**      | `alab.lock` checksum mismatch                                                                        | Lock file is out of date or tampered             |

Exits with code 1 if any warnings are found. Use `--force` on `alab migrate` to
proceed despite warnings.

#### SQL determinism (`--determinism`)

Re-parses each applied migration, re-generates its SQL, and compares the SHA-256
hash against the `sql_checksum` stored in `alab_migrations` at apply time.
Reports any migration that would produce different DDL today than it did when
originally applied — catches non-deterministic migrations (e.g. those using
`Date.now()` or environment-dependent logic).

### `alab squash`

Collapse all migrations into a single baseline migration. Useful after
accumulating many migrations over time.

```bash
# Preview what would be squashed
alab squash --dry-run

# Squash all migrations into a baseline
alab squash
```

Old migration files are archived to `.alab/archive/`. Existing environments skip
the baseline automatically; new environments apply only the baseline.

---

## Toolkit Commands

### `alab schema`

Show the schema at a specific migration revision.

```bash
alab schema
```

### `alab status`

Show schema state, migration history, verification, and drift detection in a
TUI.

```bash
alab status
```

### `alab types`

Regenerate TypeScript definitions used for IDE autocompletion inside schema
files.

```bash
alab types
```

### `alab lock`

Manage the migration lock file (`alab.lock`).

```bash
# Show lock status
alab lock status

# Verify lock file integrity
alab lock verify

# Regenerate lock file from migration files
alab lock repair

# Force-release a stuck migration lock
alab lock release --force
```

### `alab meta`

Export schema metadata to a JSON file.

```bash
alab meta
```

---

## Generator Commands

### `alab gen run`

Run a generator file and write the output to a directory.

```bash
alab gen run generators/fastapi -o ./generated
```

The `.js` extension is optional.

| Flag           | Description                     |
| -------------- | ------------------------------- |
| `-o, --output` | **Required.** Output directory. |

### `alab gen add`

Download a shared generator from a URL into `generators/`.

```bash
alab gen add https://raw.githubusercontent.com/hlop3z/astroladb/main/examples/generators/generators/fastapi.js
```

See [Code Generators](../advanced_users/generators/) for the full generator API
and sandbox reference.
